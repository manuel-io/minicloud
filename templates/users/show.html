{% extends "layout.html" %}
{% from "_macros.html" import aside with context %}
{% from "users/_macros.html" import nav, header with context %}

{% block aside %}
  {{ aside() }}
{% endblock %}

{% block nav %}
  {{ nav("show") }}
{% endblock %}

{% block header %}
  {{ header() }}
{% endblock %}

{% block section %}
  <section id="users" class="show">
    {% for user in users %}
      <section id="uc{{ loop.index }}" class="item">
        <a href="{{ url_for('users.edit', uuid = user.uuid, _anchor = 'uc' ~ loop.index) }}">
          <div>
            <p>{{ user.name }}</p>
          </div>
        </a>
        
        <div>
          <table>
            <tr>
              <td>Uploads:</td>
              <td>{{ user.uploads_count }}</td>
            </tr>
            <tr>
              <td>Tasks:</td>
              <td>{{ user.tasks_count }}</td>
            </tr>
          </table>
        </div>

        <div class="action">
          <form  action="{{ url_for('users.delete', uuid = user.uuid) }}" method="post" onsubmit="handle_delete_check(event);">
            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
            {% if current_user.id == user.id %}
              <input type="submit" value="Delete" disabled>
            {% else %}
              <input type="submit" value="Delete">
            {% endif %}
          </form>
        </div>

        <div style="display:none;">
        </div>
      </section>
    {% endfor %}
  </section>
{% endblock %}
